## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

```
ğŸ’¡ì˜ˆì œ ì‹œë‚˜ë¦¬ì˜¤

- íšŒì›ê³¼ íŒ€ì´ ìˆë‹¤.
- íšŒì›ì€ í•˜ë‚˜ì˜ íŒ€ì—ë§Œ ì†Œì†ë  ìˆ˜ ìˆë‹¤.
- íšŒì›ê³¼ íŒ€ì€ ë‹¤ëŒ€ì¼ ê´€ê³„ë‹¤.
```

âœ’ï¸ ë“¤ì–´ê°€ê¸° ì•ì„œ ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶° ëª¨ë¸ë§ í–ˆì„ ë•Œì˜ ë¬¸ì œì ì„ ì•Œì•„ë³´ì!

### ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§

ğŸ”‘ ì—°ê´€ê´€ê³„ê°€ ì—†ëŠ” ê°ì²´

<img src="https://github.com/iieunji023/jpa-with-spring-boot-basic/blob/main/images/ë‹¨ë°©í–¥1.png" width="350">

ğŸ”‘ ì°¸ì¡° ëŒ€ì‹ ì— ì™¸ë˜ í‚¤ ê·¸ëŒ€ë¡œ ì‚¬ìš©
> ì—”í‹°í‹° ìƒì„±

<details>
      <summary>Member.java</summary>

    @Entity

    public class Member {

    @Id @GeneratedValue
    @Column(name="MEMBER_ID")
    private Long id;

    @Column(name = "USERNAME")
    private String name;

    @Column(name="TEAM_ID")
    private Long  teamId;

    }

</details>

<details>
      <summary>Team.java</summary>

    @Entity
    public class Team {
    @Id
    @GeneratedValue
    @Column(name="TEAM_ID")
    private Long id;
    private String name;
    }

</details>

> í…Œì´ë¸” ìƒì„±

```
Hibernate: 
    create table Member (
        MEMBER_ID bigint not null,
        TEAM_ID bigint,
        USERNAME varchar(255),
        primary key (MEMBER_ID)
)
Hibernate: 
    create table Team (
        TEAM_ID bigint not null,
        name varchar(255),
        primary key (TEAM_ID)
)
```

ğŸ”‘  **ì™¸ë˜ í‚¤ ì‹ë³„ìë¥¼ ì§ì ‘ ë‹¤ë£¸**

> íŒ€ê³¼ íšŒì› ì €ì¥
```
Team team = new Team();

team.setName("TeamA");
em.persist(team);

Member member = new Member();
member.setUsername("member1");
member.setTeamId(team.getId());
em.persist(member);

tx.commit();
```

- `member.setTeamId(team.getId());`
    - ê°ì²´ì§€í–¥ìŠ¤ëŸ½ì§€ ì•ŠìŒ -_-..
    - `member.setTeam(~~);` ìœ¼ë¡œ í•´ì•¼ í•  ê±° ê°™ì€ë°..!

> h2 ì½˜ì†” í™•ì¸

<img src="https://github.com/iieunji023/jpa-with-spring-boot-basic/blob/main/images/ë‹¨ë°©í–¥2.png" width="200">

ğŸ”‘ ì‹ë³„ìë¡œ ë‹¤ì‹œ ì¡°íšŒ, ê°ì²´ ì§€í–¥ì ì¸ ë°©ë²•ì€ ì•„ë‹ˆë‹¤.
```
Member findMember = em.find(Member.class, member.getId());
Long findTeamId = findMember.getTeamId();
Team findTeam = em.find(Team.class, findTeamId);
```
- find()ë¥¼ í†µí•´ ê³„ì† ê°’ì„ ì°¾ì•„ì•¼ í•¨ğŸ˜‚

ğŸ’¡ ê²°ë¡ : ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ë°ì´í„° ì¤‘ì‹¬ìœ¼ë¡œ ëª¨ë¸ë§í•˜ë©´, í˜‘ë ¥ê´€ê³„ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤.

- **í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ë¡œ ì¡°ì¸**ì„ ì‚¬ìš©í•´ì„œ ì—°ê´€ëœ í…Œì´ë¸”ì„ ì°¾ëŠ”ë‹¤.
- **ê°ì²´ëŠ” ì°¸ì¡°**ë¥¼ ì‚¬ìš©í•´ì„œ ì—°ê´€ëœ ê°ì²´ë¥¼ ì°¾ëŠ”ë‹¤.
- í…Œì´ë¸”ê³¼ ê°ì²´ ì‚¬ì´ì—ëŠ” ì´ëŸ° í° ê°„ê²©ì´ ìˆë‹¤.

ë¬¸ì œì ì„ ì•Œì•„ë´¤ìœ¼ë‹ˆ ì´ëŸ° ë¬¸ì œë¥¼ í•´ì†Œí•  ìˆ˜ ìˆëŠ” ë°©ë²•ë“¤ì„ ì•Œì•„ë³´ì

## ë‹¨ë°©í–¥ ì—°ê´€ê´€ê³„

### ê°ì²´ ì§€í–¥ ëª¨ë¸ë§
ğŸ”‘ ê°ì²´ ì—°ê´€ê´€ê³„ ì‚¬ìš©
<img src="https://github.com/iieunji023/jpa-with-spring-boot-basic/blob/main/images/ë‹¨ë°©í–¥3.png" width="350">

- TeamIdê°€ ì•„ë‹Œ Team ê°ì²´ë¥¼ ì°¸ì¡°

ğŸ”‘ **ê°ì²´ì˜ ì°¸ì¡°ì™€ í…Œì´ë¸”ì˜ ì™¸ë˜ í‚¤ë¥¼ ë§¤í•‘**

> ì—”í‹°í‹° ìˆ˜ì •

<details>
      <summary>Member.java</summary>

- ìˆ˜ì • ì „
```
@Column(name="TEAM_ID")
private Long  teamId;
```
- Teamê°ì²´ê°€ ì•„ë‹Œ ì•„ì´ë””ë¡œ ë§µí•‘
- ê°ì²´ ì§€í–¥ê³¼ ë§ì§€ ì•ŠìŒ
  
- ìˆ˜ì • í›„
```
@ManyToOne
@JoinColumn(name="TEAM_ID") 
private Team team;
```
- `@ManyToOne`
  - Memberì™€ Team ê°ì²´ì˜ ê´€ê³„ë¥¼ JPAì—ê²Œ ì•Œë ¤ì£¼ê¸°
  - 1ê°œì˜ íŒ€ì— ì—¬ëŸ¬ ë©¤ë²„ê°€ ìˆìœ¼ë‹ˆê¹Œ íŒ€ì´ 1, ë©¤ë²„ê°€ N
- `@JoinColumn(name="TEAM_ID")`
  - í…Œì´ë¸” ì—°ê´€ê´€ê³„ì˜ FKì™€ ì—°ê²°ì‹œì¼œì£¼ê¸°

</details>

ğŸ”‘ **ì—°ê´€ê´€ê³„ ì €ì¥ ë° ì°¸ì¡°í˜¸ ì—°ê´€ê´€ê³„ ì¡°íšŒ**

> í…Œì´ë¸”ì— ê°’ ë“±ë¡, ì¡°íšŒ

<details>
      <summary>JpaMain.java</summary>

```
// ì €ì¥
Team team = new Team();
team.setName("TeamA");
em.persist(team);

Member member = new Member();
member.setUsername("member1");
member.setTeam(team);
em.persist(member);

// ì¡°íšŒ
Member findMember = em.find(Member.class, member.getId());
Team findTeam = findMember.getTeam();
System.out.println("findTeam.getName() = " + findTeam.getName());

tx.commit();
```

- ì¶œë ¥ ê²°ê³¼
  ```
  findTeam.getName() = TeamA
  Hibernate:
    /* insert for
    hellojpa.Team */insert
    into
    Team (name, TEAM_ID)
    values
    (?, ?)
  Hibernate:
    /* insert for
    hellojpa.Member */insert
    into
    Member (TEAM_ID, USERNAME, MEMBER_ID)
    values
    (?, ?, ?)
  ```

  - Team ê°ì²´ì˜ name í•„ë“œë¥¼ ë°”ë¡œ êº¼ë‚¼ ìˆ˜ ìˆìŒ!
- ğŸ’¡ë‹¤ì‹œ í•œë²ˆ ë³µìŠµ!
  - JPAëŠ” commití•  ë•Œ INSERT SQLë¬¸ì„ DBì— ë‚ ë¦°ë‹¤ê³  í–ˆëŠ”ë° INSERT ì „ì— Teamì˜ ê°’ì´ ì¶œë ¥ë˜ëŠ” ì´ìœ ëŠ”â“
    - `@GeneratedValue` ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ JPAì—ì„œ í•´ë‹¹ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì— ê°’ì„ ìë™ìœ¼ë¡œ ì¶”ê°€í•´ì¤€ë‹¤ê³  í–ˆëŠ”ë° ì´ëŠ” persist()ì—ì„œ ì§„í–‰ë¨!
    - ë”°ë¼ì„œ INSERT ì „ì— `@GeneratedValue` ëŠ” DBì— ë“¤ì–´ê°€ê¸° ë•Œë¬¸ì— ê°’ì„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤!
  - DBë‘ ì‹±í¬ë¥¼ ì™„ì „íˆ ë§ì¶”ê³  ì‹¶ë‹¤ë©´ `em.flush()`, `em.clean()`ì„ í†µí•´ ì˜ì†ì„±ì„ ì™„ì „íˆ ëŠê²Œ ë˜ë©°, DBì— ì¿¼ë¦¬ê°€ ë°”ë¡œ ë‚ ë¼ê°!
    ```
    Hibernate: 
    /* insert for
        hellojpa.Team */insert 
    into
        Team (name, TEAM_ID) 
    values
        (?, ?) 
    Hibernate:
    /* insert for
    hellojpa.Member */insert
    into
    Member (TEAM_ID, USERNAME, MEMBER_ID)
    values
    (?, ?, ?)
    Hibernate:
    select 
    m1_0.MEMBER_ID,
    t1_0.TEAM_ID,
    t1_0.name,
    m1_0.USERNAME
    from
    Member m1_0
    left join
    Team t1_0
    on t1_0.TEAM_ID=m1_0.TEAM_ID
    where
    m1_0.MEMBER_ID=?
    findTeam.getName() = TeamA
    ```
    - INSERT ì´í›„ ì¡°íšŒ

</details>

ğŸ”‘ ORM ë§¤í•‘

<img src="https://github.com/iieunji023/jpa-with-spring-boot-basic/blob/main/images/ë‹¨ë°©í–¥4.png" width="350">

ğŸ”‘ **ì—°ê´€ê´€ê³„ ìˆ˜ì •**

- TeamAë¥¼  TeamBë¡œ ë³€ê²½í•˜ê³  ì‹¶ì„ ë•Œ
- JpaMain.java

    ```
    Team newTeam = em.find(Team.class, 100L);
    findMember.setTeam(newTeam);
    ```

  - Team í…Œì´ë¸”ì˜ Idê°€ 100ì¸ íŒ€ìœ¼ë¡œ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´ ìœ„ ì½”ë“œì²˜ëŸ¼ë§Œ í•´ì£¼ë©´ ëœë‹¤

<br>

